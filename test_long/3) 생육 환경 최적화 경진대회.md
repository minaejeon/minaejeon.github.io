# 3) 생육 환경 최적화 경진대회


```python
# This Python 3 environment comes with many helpful analytics libraries installed
# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python
# For example, here's several helpful packages to load

import numpy as np # linear algebra
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)

# Input data files are available in the read-only "../input/" directory
# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory

import os
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames[:1]:
        print(os.path.join(dirname, filename))

# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using "Save & Run All" 
# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session
```


/kaggle/input/dataset/sample_submission.csv
/kaggle/input/dataset/test/meta/142.csv
/kaggle/input/dataset/test/image/173.png
/kaggle/input/dataset/train/CASE12/label.csv
/kaggle/input/dataset/train/CASE12/meta/CASE12_25.csv
/kaggle/input/dataset/train/CASE12/image/CASE12_32.png
/kaggle/input/dataset/train/CASE36/label.csv
/kaggle/input/dataset/train/CASE36/meta/CASE36_14.csv
/kaggle/input/dataset/train/CASE36/image/CASE36_06.png
/kaggle/input/dataset/train/CASE69/label.csv
/kaggle/input/dataset/train/CASE69/meta/CASE69_19.csv
/kaggle/input/dataset/train/CASE69/image/CASE69_17.png
/kaggle/input/dataset/train/CASE05/label.csv
/kaggle/input/dataset/train/CASE05/meta/CASE05_16.csv
/kaggle/input/dataset/train/CASE05/image/CASE05_14.png
/kaggle/input/dataset/train/CASE22/label.csv
/kaggle/input/dataset/train/CASE22/meta/CASE22_02.csv
/kaggle/input/dataset/train/CASE22/image/CASE22_06.jpg
/kaggle/input/dataset/train/CASE20/label.csv
/kaggle/input/dataset/train/CASE20/meta/CASE20_05.csv
/kaggle/input/dataset/train/CASE20/image/CASE20_10.jpg
/kaggle/input/dataset/train/CASE44/label.csv
/kaggle/input/dataset/train/CASE44/meta/CASE44_15.csv
/kaggle/input/dataset/train/CASE44/image/CASE44_07.png
/kaggle/input/dataset/train/CASE50/label.csv
/kaggle/input/dataset/train/CASE50/meta/CASE50_26.csv
/kaggle/input/dataset/train/CASE50/image/CASE50_07.png
/kaggle/input/dataset/train/CASE37/label.csv
/kaggle/input/dataset/train/CASE37/meta/CASE37_25.csv
/kaggle/input/dataset/train/CASE37/image/CASE37_27.png
/kaggle/input/dataset/train/CASE39/label.csv
/kaggle/input/dataset/train/CASE39/meta/CASE39_09.csv
/kaggle/input/dataset/train/CASE39/image/CASE39_16.png
/kaggle/input/dataset/train/CASE29/label.csv
/kaggle/input/dataset/train/CASE29/meta/CASE29_08.csv
/kaggle/input/dataset/train/CASE29/image/CASE29_01.jpg
/kaggle/input/dataset/train/CASE27/label.csv
/kaggle/input/dataset/train/CASE27/meta/CASE27_04.csv
/kaggle/input/dataset/train/CASE27/image/CASE27_05.jpg
/kaggle/input/dataset/train/CASE48/label.csv
/kaggle/input/dataset/train/CASE48/meta/CASE48_02.csv
/kaggle/input/dataset/train/CASE48/image/CASE48_01.png
/kaggle/input/dataset/train/CASE21/label.csv
/kaggle/input/dataset/train/CASE21/meta/CASE21_07.csv
/kaggle/input/dataset/train/CASE21/image/CASE21_04.jpg
/kaggle/input/dataset/train/CASE67/label.csv
/kaggle/input/dataset/train/CASE67/meta/CASE67_17.csv
/kaggle/input/dataset/train/CASE67/image/CASE67_25.png
/kaggle/input/dataset/train/CASE71/label.csv
/kaggle/input/dataset/train/CASE71/meta/CASE71_22.csv
/kaggle/input/dataset/train/CASE71/image/CASE71_22.png
/kaggle/input/dataset/train/CASE60/label.csv
/kaggle/input/dataset/train/CASE60/meta/CASE60_01.csv
/kaggle/input/dataset/train/CASE60/image/CASE60_20.png
/kaggle/input/dataset/train/CASE53/label.csv
/kaggle/input/dataset/train/CASE53/meta/CASE53_18.csv
/kaggle/input/dataset/train/CASE53/image/CASE53_09.png
/kaggle/input/dataset/train/CASE46/label.csv
/kaggle/input/dataset/train/CASE46/meta/CASE46_06.csv
/kaggle/input/dataset/train/CASE46/image/CASE46_14.png
/kaggle/input/dataset/train/CASE41/label.csv
/kaggle/input/dataset/train/CASE41/meta/CASE41_21.csv
/kaggle/input/dataset/train/CASE41/image/CASE41_13.png
/kaggle/input/dataset/train/CASE68/label.csv
/kaggle/input/dataset/train/CASE68/meta/CASE68_18.csv
/kaggle/input/dataset/train/CASE68/image/CASE68_23.png
/kaggle/input/dataset/train/CASE43/label.csv
/kaggle/input/dataset/train/CASE43/meta/CASE43_18.csv
/kaggle/input/dataset/train/CASE43/image/CASE43_28.png
/kaggle/input/dataset/train/CASE03/label.csv
/kaggle/input/dataset/train/CASE03/meta/CASE03_01.csv
/kaggle/input/dataset/train/CASE03/image/CASE03_05.png
/kaggle/input/dataset/train/CASE13/label.csv
/kaggle/input/dataset/train/CASE13/meta/CASE13_04.csv
/kaggle/input/dataset/train/CASE13/image/CASE13_24.png
/kaggle/input/dataset/train/CASE04/label.csv
/kaggle/input/dataset/train/CASE04/meta/CASE04_20.csv
/kaggle/input/dataset/train/CASE04/image/CASE04_03.png
/kaggle/input/dataset/train/CASE45/label.csv
/kaggle/input/dataset/train/CASE45/meta/CASE45_23.csv
/kaggle/input/dataset/train/CASE45/image/CASE45_09.png
/kaggle/input/dataset/train/CASE63/label.csv
/kaggle/input/dataset/train/CASE63/meta/CASE63_07.csv
/kaggle/input/dataset/train/CASE63/image/CASE63_04.png
/kaggle/input/dataset/train/CASE42/label.csv
/kaggle/input/dataset/train/CASE42/meta/CASE42_23.csv
/kaggle/input/dataset/train/CASE42/image/CASE42_28.png
/kaggle/input/dataset/train/CASE70/label.csv
/kaggle/input/dataset/train/CASE70/meta/CASE70_20.csv
/kaggle/input/dataset/train/CASE70/image/CASE70_19.png
/kaggle/input/dataset/train/CASE73/label.csv
/kaggle/input/dataset/train/CASE73/meta/CASE73_33.csv
/kaggle/input/dataset/train/CASE73/image/CASE73_33.png
/kaggle/input/dataset/train/CASE61/label.csv
/kaggle/input/dataset/train/CASE61/meta/CASE61_09.csv
/kaggle/input/dataset/train/CASE61/image/CASE61_04.png
/kaggle/input/dataset/train/CASE75/label.csv
/kaggle/input/dataset/train/CASE75/meta/CASE75_02.csv
/kaggle/input/dataset/train/CASE75/image/CASE75_01.png
/kaggle/input/dataset/train/CASE59/label.csv
/kaggle/input/dataset/train/CASE59/meta/CASE59_08.csv
/kaggle/input/dataset/train/CASE59/image/CASE59_19.png
/kaggle/input/dataset/train/CASE14/label.csv
/kaggle/input/dataset/train/CASE14/meta/CASE14_23.csv
/kaggle/input/dataset/train/CASE14/image/CASE14_23.png
/kaggle/input/dataset/train/CASE30/label.csv
/kaggle/input/dataset/train/CASE30/meta/CASE30_10.csv
/kaggle/input/dataset/train/CASE30/image/CASE30_11.jpg
/kaggle/input/dataset/train/CASE16/label.csv
/kaggle/input/dataset/train/CASE16/meta/CASE16_03.csv
/kaggle/input/dataset/train/CASE16/image/CASE16_01.jpg
/kaggle/input/dataset/train/CASE52/label.csv
/kaggle/input/dataset/train/CASE52/meta/CASE52_17.csv
/kaggle/input/dataset/train/CASE52/image/CASE52_22.png
/kaggle/input/dataset/train/CASE26/label.csv
/kaggle/input/dataset/train/CASE26/meta/CASE26_42.csv
/kaggle/input/dataset/train/CASE26/image/CASE26_09.png
/kaggle/input/dataset/train/CASE19/label.csv
/kaggle/input/dataset/train/CASE19/meta/CASE19_04.csv
/kaggle/input/dataset/train/CASE19/image/CASE19_04.jpg
/kaggle/input/dataset/train/CASE47/label.csv
/kaggle/input/dataset/train/CASE47/meta/CASE47_01.csv
/kaggle/input/dataset/train/CASE47/image/CASE47_08.png
/kaggle/input/dataset/train/CASE51/label.csv
/kaggle/input/dataset/train/CASE51/meta/CASE51_03.csv
/kaggle/input/dataset/train/CASE51/image/CASE51_05.png
/kaggle/input/dataset/train/CASE54/label.csv
/kaggle/input/dataset/train/CASE54/meta/CASE54_16.csv
/kaggle/input/dataset/train/CASE54/image/CASE54_23.png
/kaggle/input/dataset/train/CASE11/label.csv
/kaggle/input/dataset/train/CASE11/meta/CASE11_04.csv
/kaggle/input/dataset/train/CASE11/image/CASE11_07.png
/kaggle/input/dataset/train/CASE25/label.csv
/kaggle/input/dataset/train/CASE25/meta/CASE25_10.csv
/kaggle/input/dataset/train/CASE25/image/CASE25_09.png
/kaggle/input/dataset/train/CASE49/label.csv
/kaggle/input/dataset/train/CASE49/meta/CASE49_30.csv
/kaggle/input/dataset/train/CASE49/image/CASE49_32.png
/kaggle/input/dataset/train/CASE08/label.csv
/kaggle/input/dataset/train/CASE08/meta/CASE08_06.csv
/kaggle/input/dataset/train/CASE08/image/CASE08_08.jpg
/kaggle/input/dataset/train/CASE18/label.csv
/kaggle/input/dataset/train/CASE18/meta/CASE18_11.csv
/kaggle/input/dataset/train/CASE18/image/CASE18_10.jpg
/kaggle/input/dataset/train/CASE40/label.csv
/kaggle/input/dataset/train/CASE40/meta/CASE40_25.csv
/kaggle/input/dataset/train/CASE40/image/CASE40_09.png
/kaggle/input/dataset/train/CASE72/label.csv
/kaggle/input/dataset/train/CASE72/meta/CASE72_09.csv
/kaggle/input/dataset/train/CASE72/image/CASE72_09.png
/kaggle/input/dataset/train/CASE64/label.csv
/kaggle/input/dataset/train/CASE64/meta/CASE64_14.csv
/kaggle/input/dataset/train/CASE64/image/CASE64_16.png
/kaggle/input/dataset/train/CASE66/label.csv
/kaggle/input/dataset/train/CASE66/meta/CASE66_01.csv
/kaggle/input/dataset/train/CASE66/image/CASE66_01.png
/kaggle/input/dataset/train/CASE38/label.csv
/kaggle/input/dataset/train/CASE38/meta/CASE38_03.csv
/kaggle/input/dataset/train/CASE38/image/CASE38_07.png
/kaggle/input/dataset/train/CASE62/label.csv
/kaggle/input/dataset/train/CASE62/meta/CASE62_03.csv
/kaggle/input/dataset/train/CASE62/image/CASE62_19.png
/kaggle/input/dataset/train/CASE57/label.csv
/kaggle/input/dataset/train/CASE57/meta/CASE57_14.csv
/kaggle/input/dataset/train/CASE57/image/CASE57_02.png
/kaggle/input/dataset/train/CASE23/label.csv
/kaggle/input/dataset/train/CASE23/meta/CASE23_07.csv
/kaggle/input/dataset/train/CASE23/image/CASE23_01.jpg
/kaggle/input/dataset/train/CASE31/label.csv
/kaggle/input/dataset/train/CASE31/meta/CASE31_07.csv
/kaggle/input/dataset/train/CASE31/image/CASE31_06.jpg
/kaggle/input/dataset/train/CASE32/label.csv
/kaggle/input/dataset/train/CASE32/meta/CASE32_18.csv
/kaggle/input/dataset/train/CASE32/image/CASE32_14.png
/kaggle/input/dataset/train/CASE65/label.csv
/kaggle/input/dataset/train/CASE65/meta/CASE65_01.csv
/kaggle/input/dataset/train/CASE65/image/CASE65_01.png
/kaggle/input/dataset/train/CASE06/label.csv
/kaggle/input/dataset/train/CASE06/meta/CASE06_04.csv
/kaggle/input/dataset/train/CASE06/image/CASE06_08.jpg
/kaggle/input/dataset/train/CASE74/label.csv
/kaggle/input/dataset/train/CASE74/meta/CASE74_27.csv
/kaggle/input/dataset/train/CASE74/image/CASE74_16.png
/kaggle/input/dataset/train/CASE28/label.csv
/kaggle/input/dataset/train/CASE28/meta/CASE28_06.csv
/kaggle/input/dataset/train/CASE28/image/CASE28_04.jpg
/kaggle/input/dataset/train/CASE10/label.csv
/kaggle/input/dataset/train/CASE10/meta/CASE10_06.csv
/kaggle/input/dataset/train/CASE10/image/CASE10_13.png
/kaggle/input/dataset/train/CASE24/label.csv
/kaggle/input/dataset/train/CASE24/meta/CASE24_03.csv
/kaggle/input/dataset/train/CASE24/image/CASE24_05.png
/kaggle/input/dataset/train/CASE09/label.csv
/kaggle/input/dataset/train/CASE09/meta/CASE09_01.csv
/kaggle/input/dataset/train/CASE09/image/CASE09_06.jpg
/kaggle/input/dataset/train/CASE07/label.csv
/kaggle/input/dataset/train/CASE07/meta/CASE07_05.csv
/kaggle/input/dataset/train/CASE07/image/CASE07_07.jpg
/kaggle/input/dataset/train/CASE02/label.csv
/kaggle/input/dataset/train/CASE02/meta/CASE02_05.csv
/kaggle/input/dataset/train/CASE02/image/CASE02_05.png
/kaggle/input/dataset/train/CASE55/label.csv
/kaggle/input/dataset/train/CASE55/meta/CASE55_13.csv
/kaggle/input/dataset/train/CASE55/image/CASE55_19.png
/kaggle/input/dataset/train/CASE01/label.csv
/kaggle/input/dataset/train/CASE01/meta/CASE01_04.csv
/kaggle/input/dataset/train/CASE01/image/CASE01_02.png
/kaggle/input/dataset/train/CASE34/label.csv
/kaggle/input/dataset/train/CASE34/meta/CASE34_19.csv
/kaggle/input/dataset/train/CASE34/image/CASE34_05.png
/kaggle/input/dataset/train/CASE35/label.csv
/kaggle/input/dataset/train/CASE35/meta/CASE35_27.csv
/kaggle/input/dataset/train/CASE35/image/CASE35_26.png
/kaggle/input/dataset/train/CASE15/label.csv
/kaggle/input/dataset/train/CASE15/meta/CASE15_04.csv
/kaggle/input/dataset/train/CASE15/image/CASE15_01.jpg
/kaggle/input/dataset/train/CASE58/label.csv
/kaggle/input/dataset/train/CASE58/meta/CASE58_19.csv
/kaggle/input/dataset/train/CASE58/image/CASE58_04.png
/kaggle/input/dataset/train/CASE17/label.csv
/kaggle/input/dataset/train/CASE17/meta/CASE17_02.csv
/kaggle/input/dataset/train/CASE17/image/CASE17_03.jpg
/kaggle/input/dataset/train/CASE33/label.csv
/kaggle/input/dataset/train/CASE33/meta/CASE33_08.csv
/kaggle/input/dataset/train/CASE33/image/CASE33_17.png
/kaggle/input/dataset/train/CASE56/label.csv
/kaggle/input/dataset/train/CASE56/meta/CASE56_11.csv
/kaggle/input/dataset/train/CASE56/image/CASE56_22.png
</pre>
```python
import glob
train=pd.DataFrame({'path':glob.glob('/kaggle/input/dataset/train/*/image/*')})
pd.options.display.max_colwidth=99
train
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 1 columns</p>
</div>



```python
label=pd.read_csv('/kaggle/input/dataset/train/CASE35/label.csv')
label
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CASE35_01.png</td>
      <td>0.348</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CASE35_02.png</td>
      <td>1.157</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CASE35_03.png</td>
      <td>1.974</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CASE35_04.png</td>
      <td>2.575</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CASE35_05.png</td>
      <td>3.119</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CASE35_06.png</td>
      <td>4.434</td>
    </tr>
    <tr>
      <th>6</th>
      <td>CASE35_07.png</td>
      <td>6.013</td>
    </tr>
    <tr>
      <th>7</th>
      <td>CASE35_08.png</td>
      <td>8.432</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CASE35_09.png</td>
      <td>11.703</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CASE35_10.png</td>
      <td>15.088</td>
    </tr>
    <tr>
      <th>10</th>
      <td>CASE35_11.png</td>
      <td>20.885</td>
    </tr>
    <tr>
      <th>11</th>
      <td>CASE35_12.png</td>
      <td>28.298</td>
    </tr>
    <tr>
      <th>12</th>
      <td>CASE35_13.png</td>
      <td>38.251</td>
    </tr>
    <tr>
      <th>13</th>
      <td>CASE35_14.png</td>
      <td>49.132</td>
    </tr>
    <tr>
      <th>14</th>
      <td>CASE35_15.png</td>
      <td>63.277</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CASE35_16.png</td>
      <td>83.856</td>
    </tr>
    <tr>
      <th>16</th>
      <td>CASE35_17.png</td>
      <td>106.120</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CASE35_18.png</td>
      <td>133.164</td>
    </tr>
    <tr>
      <th>18</th>
      <td>CASE35_19.png</td>
      <td>160.963</td>
    </tr>
    <tr>
      <th>19</th>
      <td>CASE35_20.png</td>
      <td>190.768</td>
    </tr>
    <tr>
      <th>20</th>
      <td>CASE35_21.png</td>
      <td>230.770</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CASE35_22.png</td>
      <td>277.233</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CASE35_23.png</td>
      <td>327.570</td>
    </tr>
    <tr>
      <th>23</th>
      <td>CASE35_24.png</td>
      <td>376.460</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CASE35_25.png</td>
      <td>393.269</td>
    </tr>
    <tr>
      <th>25</th>
      <td>CASE35_26.png</td>
      <td>433.624</td>
    </tr>
    <tr>
      <th>26</th>
      <td>CASE35_27.png</td>
      <td>469.019</td>
    </tr>
  </tbody>
</table>
</div>



```python
label_list=[]
for path in glob.glob('/kaggle/input/dataset/train/*/label.csv'):
    label=pd.read_csv(path)
    label_list.append(label)
label_csv=pd.concat(label_list)
label_csv
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CASE12_01.png</td>
      <td>0.025</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CASE12_02.png</td>
      <td>0.085</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CASE12_03.png</td>
      <td>0.118</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CASE12_04.png</td>
      <td>0.184</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CASE12_05.png</td>
      <td>0.345</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CASE56_23.png</td>
      <td>131.028</td>
    </tr>
    <tr>
      <th>23</th>
      <td>CASE56_24.png</td>
      <td>160.933</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CASE56_25.png</td>
      <td>179.876</td>
    </tr>
    <tr>
      <th>25</th>
      <td>CASE56_26.png</td>
      <td>219.150</td>
    </tr>
    <tr>
      <th>26</th>
      <td>CASE56_27.png</td>
      <td>227.165</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 2 columns</p>
</div>



```python
train['img_name']=train['path'].apply(lambda x : x.split('/')[-1])
train
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
      <th>img_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
      <td>CASE12_32.png</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
      <td>CASE12_20.png</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
      <td>CASE12_39.png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
      <td>CASE12_23.png</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
      <td>CASE12_17.png</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
      <td>CASE56_24.png</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
      <td>CASE56_18.png</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
      <td>CASE56_06.png</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
      <td>CASE56_01.png</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
      <td>CASE56_07.png</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 2 columns</p>
</div>



```python
train=pd.merge(train,label_csv,how='left',on='img_name')
train
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
      <td>CASE12_32.png</td>
      <td>40.688</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
      <td>CASE12_20.png</td>
      <td>31.108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
      <td>CASE12_39.png</td>
      <td>43.051</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
      <td>CASE12_23.png</td>
      <td>34.620</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
      <td>CASE12_17.png</td>
      <td>20.122</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
      <td>CASE56_24.png</td>
      <td>160.933</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
      <td>CASE56_18.png</td>
      <td>53.014</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
      <td>CASE56_06.png</td>
      <td>1.472</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
      <td>CASE56_01.png</td>
      <td>0.149</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
      <td>CASE56_07.png</td>
      <td>1.894</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 3 columns</p>
</div>



```python
train['leaf_weight']=np.log(train['leaf_weight'])
train
```


/opt/conda/lib/python3.7/site-packages/pandas/core/arraylike.py:364: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
      <td>CASE12_32.png</td>
      <td>3.705933</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
      <td>CASE12_20.png</td>
      <td>3.437465</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
      <td>CASE12_39.png</td>
      <td>3.762385</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
      <td>CASE12_23.png</td>
      <td>3.544432</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
      <td>CASE12_17.png</td>
      <td>3.001814</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
      <td>CASE56_24.png</td>
      <td>5.080988</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
      <td>CASE56_18.png</td>
      <td>3.970556</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
      <td>CASE56_06.png</td>
      <td>0.386622</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
      <td>CASE56_01.png</td>
      <td>-1.903809</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
      <td>CASE56_07.png</td>
      <td>0.638691</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 3 columns</p>
</div>



```python
train['case']=train['img_name'].apply(lambda x : x.split('_')[-2])
case=train['case'].astype(str)
case
```


0       CASE12
1       CASE12
2       CASE12
3       CASE12
4       CASE12
         ...  
1587    CASE56
1588    CASE56
1589    CASE56
1590    CASE56
1591    CASE56
Name: case, Length: 1592, dtype: object


```python
img_name=train['img_name'].astype(str)
img_name
```


0       CASE12_32.png
1       CASE12_20.png
2       CASE12_39.png
3       CASE12_23.png
4       CASE12_17.png
            ...      
1587    CASE56_24.png
1588    CASE56_18.png
1589    CASE56_06.png
1590    CASE56_01.png
1591    CASE56_07.png
Name: img_name, Length: 1592, dtype: object


```python
import albumentations as al
aug=al.Compose([al.HorizontalFlip(p=0.5),al.Rotate(limit=360,p=0.5),al.Resize(256,256)])
```

/kaggle/input/dataset/train/CASE12/image/CASE12_32.png



```python
import cv2
import shutil # image open 대신 cv2.imread로 가져오면 변형된 값으로 array (픽셀값)으로 바로 처리 가능
from tqdm import tqdm
for category in tqdm(img_name):
    os.makedirs('256_train/'+category, exist_ok=True) # macro f1 score / 88개의 class 구분, 데이터 격차가 큰 상태, outlier1이 가장 데이터가 적은 경우 > folder 이름 저장 필요(이미지를 늘렸을 때 구분) 362_train/으로 한번에 압축//exist_ok=True
    for path in train[train['img_name']==category]['path']:
        image=cv2.imread(path)
        aug=al.Compose([al.HorizontalFlip(p=0.5),al.Rotate(limit=360,p=0.5),al.Resize(256,256)]) # for 문 밖에서도 가능
        aug_dict=aug(image=image)
        augmented_image=aug_dict['image'] # aug 적용된 image 
        category_split=category.split('_')[-2]
        path_split=path.split('/')[-1] #path가 문자열이므로 split 적용 // 파일 이름만 나올 수 있게
        cv2.imwrite('/kaggle/input/dataset/train/'+category_split+'/image/'+path_split,augmented_image) #cv2.imwrite('362_train/'+category+'/'+path_split) 이미지가 중복 될 우려, 이미지가 만들어 질 때 새롭게 저장 필요 / path split에 .png 확장자 포함
shutil.make_archive('256_train','zip','256_train')#(파일이름,압축형태,폴더이름)
```

<pre>
100%|██████████| 1592/1592 [05:26<00:00,  4.88it/s]
</pre>
<pre>
'/kaggle/working/256_train.zip'
</pre>

```python
train
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
      <th>img_name</th>
      <th>leaf_weight</th>
      <th>case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
      <td>CASE12_32.png</td>
      <td>3.705933</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
      <td>CASE12_20.png</td>
      <td>3.437465</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
      <td>CASE12_39.png</td>
      <td>3.762385</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
      <td>CASE12_23.png</td>
      <td>3.544432</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
      <td>CASE12_17.png</td>
      <td>3.001814</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
      <td>CASE56_24.png</td>
      <td>5.080988</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
      <td>CASE56_18.png</td>
      <td>3.970556</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
      <td>CASE56_06.png</td>
      <td>0.386622</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
      <td>CASE56_01.png</td>
      <td>-1.903809</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
      <td>CASE56_07.png</td>
      <td>0.638691</td>
      <td>CASE56</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 4 columns</p>
</div>



```python
train['leaf_weight'] = [0 if i < 0 else i for i in train['leaf_weight']]
train
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
      <th>img_name</th>
      <th>leaf_weight</th>
      <th>case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_32.png</td>
      <td>CASE12_32.png</td>
      <td>3.705933</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_20.png</td>
      <td>CASE12_20.png</td>
      <td>3.437465</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_39.png</td>
      <td>CASE12_39.png</td>
      <td>3.762385</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_23.png</td>
      <td>CASE12_23.png</td>
      <td>3.544432</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/train/CASE12/image/CASE12_17.png</td>
      <td>CASE12_17.png</td>
      <td>3.001814</td>
      <td>CASE12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_24.png</td>
      <td>CASE56_24.png</td>
      <td>5.080988</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1588</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_18.png</td>
      <td>CASE56_18.png</td>
      <td>3.970556</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1589</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_06.png</td>
      <td>CASE56_06.png</td>
      <td>0.386622</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1590</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_01.png</td>
      <td>CASE56_01.png</td>
      <td>0.000000</td>
      <td>CASE56</td>
    </tr>
    <tr>
      <th>1591</th>
      <td>/kaggle/input/dataset/train/CASE56/image/CASE56_07.png</td>
      <td>CASE56_07.png</td>
      <td>0.638691</td>
      <td>CASE56</td>
    </tr>
  </tbody>
</table>
<p>1592 rows × 4 columns</p>
</div>



```python
# from sklearn.model_selection import train_test_split
# x_train, x_valid = train_test_split(train, test_size=0.2, random_state=42, stratify=train['leaf_weight'])
```


```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator
idg=ImageDataGenerator()
```


```python
train_generator=idg.flow_from_dataframe(train,x_col='path',y_col='leaf_weight',class_mode='raw')

#회귀 문제, default class_mode=categorical > raw로 변경
```

<pre>
Found 1592 validated image filenames.
</pre>

```python
# valid_generator=idg.flow_from_dataframe(x_valid, x_col='path', y_col='leaf_weight', class_mode='raw')
```


```python
```


```python
from tensorflow.keras import *
from tensorflow.keras.layers import *
from tensorflow.keras.callbacks import *
from tensorflow.keras.applications.efficientnet import *
```


```python
# test=pd.read_csv('/kaggle/input/dataset/sample_submission.csv')
# test
```

image 사이즈 줄이기



```python
es=EarlyStopping(patience=4, restore_best_weights=True)
rl=ReduceLROnPlateau(patience=3, verbose=1)
model=Sequential()
model.add(EfficientNetB1(include_top=False,pooling='avg'))
model.add(Dense(1, activation='linear')) #회귀 input 1
model.compile(optimizer='adam', metrics='mae', loss='mse')

model.fit(train_generator,epochs=13, callbacks=[es,rl])
```

Epoch 1/13
50/50 [==============================] - 271s 5s/step - loss: 1.4170 - mae: 0.8256
Epoch 2/13
50/50 [==============================] - 268s 5s/step - loss: 0.1416 - mae: 0.2909
Epoch 3/13
50/50 [==============================] - 266s 5s/step - loss: 0.0722 - mae: 0.2087
Epoch 4/13
50/50 [==============================] - 265s 5s/step - loss: 0.0446 - mae: 0.1610
Epoch 5/13
50/50 [==============================] - 264s 5s/step - loss: 0.0365 - mae: 0.1520
Epoch 6/13
50/50 [==============================] - 264s 5s/step - loss: 0.0599 - mae: 0.1921
Epoch 7/13
50/50 [==============================] - 264s 5s/step - loss: 0.0463 - mae: 0.1687
Epoch 8/13
50/50 [==============================] - 263s 5s/step - loss: 0.0262 - mae: 0.1255
Epoch 9/13
50/50 [==============================] - 261s 5s/step - loss: 0.0204 - mae: 0.1092
Epoch 10/13
50/50 [==============================] - 264s 5s/step - loss: 0.0242 - mae: 0.1208
Epoch 11/13
50/50 [==============================] - 266s 5s/step - loss: 0.0173 - mae: 0.1012
Epoch 12/13
50/50 [==============================] - 264s 5s/step - loss: 0.0255 - mae: 0.1239
Epoch 13/13
50/50 [==============================] - 264s 5s/step - loss: 0.0328 - mae: 0.1434

<keras.callbacks.History at 0x7fa6d83d1250>

Epoch 13/1000



50/50 [==============================] - 291s 6s/step - loss: 0.0145 - mae: 0.0930



```python
test=pd.read_csv('/kaggle/input/dataset/sample_submission.csv')
test
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>456.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>456</th>
      <td>457.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>457</th>
      <td>458.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>458</th>
      <td>459.png</td>
      <td>0</td>
    </tr>
    <tr>
      <th>459</th>
      <td>460.png</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>460 rows × 2 columns</p>
</div>



```python
import glob
test=pd.DataFrame({'path':glob.glob('/kaggle/input/dataset/test/image/*')})
test
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/test/image/173.png</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/test/image/043.png</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/test/image/248.png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/test/image/333.jpg</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/test/image/038.png</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>/kaggle/input/dataset/test/image/428.png</td>
    </tr>
    <tr>
      <th>456</th>
      <td>/kaggle/input/dataset/test/image/217.png</td>
    </tr>
    <tr>
      <th>457</th>
      <td>/kaggle/input/dataset/test/image/418.png</td>
    </tr>
    <tr>
      <th>458</th>
      <td>/kaggle/input/dataset/test/image/452.png</td>
    </tr>
    <tr>
      <th>459</th>
      <td>/kaggle/input/dataset/test/image/306.png</td>
    </tr>
  </tbody>
</table>
<p>460 rows × 1 columns</p>
</div>


glob 이후 정렬 : 1,2 일 경우 문자로 인식하지 않게 바꾼후



```python
test=test.sort_values('path').reset_index(drop=True) #drop : index가 column으로 만들어지지 않게
test
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/kaggle/input/dataset/test/image/001.png</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/kaggle/input/dataset/test/image/002.png</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/kaggle/input/dataset/test/image/003.png</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/kaggle/input/dataset/test/image/004.png</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/kaggle/input/dataset/test/image/005.png</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>/kaggle/input/dataset/test/image/456.png</td>
    </tr>
    <tr>
      <th>456</th>
      <td>/kaggle/input/dataset/test/image/457.png</td>
    </tr>
    <tr>
      <th>457</th>
      <td>/kaggle/input/dataset/test/image/458.png</td>
    </tr>
    <tr>
      <th>458</th>
      <td>/kaggle/input/dataset/test/image/459.png</td>
    </tr>
    <tr>
      <th>459</th>
      <td>/kaggle/input/dataset/test/image/460.png</td>
    </tr>
  </tbody>
</table>
<p>460 rows × 1 columns</p>
</div>



```python
from tensorflow.keras.preprocessing.image import ImageDataGenerator
idg_test=ImageDataGenerator()
```


```python
test_generator=idg_test.flow_from_dataframe(test, x_col='path', y_col=None, shuffle=False, class_mode=None)
```

<pre>
Found 460 validated image filenames.
</pre>

```python
result=model.predict(test_generator,verbose=1,workers=2)
```

<pre>
15/15 [==============================] - 88s 5s/step
</pre>
result를 image로 예측 가능 : Dense layer 대신 다른 층 (ex 악성 종양...)


-값은 0으로 바꿔서 제출



```python
result=np.exp(result)
```


```python
result.shape
```


(460, 1)


```python
sub=pd.read_csv('/kaggle/input/dataset/sample_submission.csv')
```


```python
train.describe() # 0~481 
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1592.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.231351</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.824278</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.764131</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.557873</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.777877</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.176647</td>
    </tr>
  </tbody>
</table>
</div>


result가 음수로 나오는 문제 : log이용 // 256 resize 이후 train/test dataset에 저장해두기



```python
result = [0 if i < 0 else i for i in result]
result
```

[array([67.874146], dtype=float32),

 array([312.3977], dtype=float32),

 array([5.737878], dtype=float32),

 array([85.7598], dtype=float32),

 array([89.80581], dtype=float32),

 array([89.20752], dtype=float32),

 array([1.2003134], dtype=float32),

 array([85.48924], dtype=float32),

 array([1.0934514], dtype=float32),

 array([87.02903], dtype=float32),

 
...

 array([65.20689], dtype=float32),

 array([89.601395], dtype=float32),

 array([39.58943], dtype=float32),

 array([61.912693], dtype=float32),

 array([253.98407], dtype=float32)]



```python
result
```

Output exceeds the size limit. Open the full output data in a text editor

[array([67.874146], dtype=float32),

 array([312.3977], dtype=float32),

 array([5.737878], dtype=float32),

 array([85.7598], dtype=float32),

 array([89.80581], dtype=float32),

 array([89.20752], dtype=float32),

 array([1.2003134], dtype=float32),

 array([85.48924], dtype=float32),

 array([1.0934514], dtype=float32),

 array([87.02903], dtype=float32),

 array([1.0166383], dtype=float32),

 
...

 array([65.20689], dtype=float32),

 array([89.601395], dtype=float32),

 array([39.58943], dtype=float32),

 array([61.912693], dtype=float32),

 array([253.98407], dtype=float32)]



```python
sub['leaf_weight']=result
```


```python
sub['leaf_weight']=sub['leaf_weight'].astype(float)
sub
```

<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>img_name</th>
      <th>leaf_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>001.png</td>
      <td>67.874146</td>
    </tr>
    <tr>
      <th>1</th>
      <td>002.png</td>
      <td>312.397705</td>
    </tr>
    <tr>
      <th>2</th>
      <td>003.png</td>
      <td>5.737878</td>
    </tr>
    <tr>
      <th>3</th>
      <td>004.png</td>
      <td>85.759804</td>
    </tr>
    <tr>
      <th>4</th>
      <td>005.png</td>
      <td>89.805809</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>456.png</td>
      <td>65.206886</td>
    </tr>
    <tr>
      <th>456</th>
      <td>457.png</td>
      <td>89.601395</td>
    </tr>
    <tr>
      <th>457</th>
      <td>458.png</td>
      <td>39.589432</td>
    </tr>
    <tr>
      <th>458</th>
      <td>459.png</td>
      <td>61.912693</td>
    </tr>
    <tr>
      <th>459</th>
      <td>460.png</td>
      <td>253.984070</td>
    </tr>
  </tbody>
</table>
<p>460 rows × 2 columns</p>
</div>



```python
sub.to_csv('origin_epoch13.csv',index=False)
```
